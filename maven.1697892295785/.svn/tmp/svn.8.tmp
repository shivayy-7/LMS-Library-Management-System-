<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags" %>
<script type="text/javascript" src="${contextPath}/assets/appJs/validation/common-utils.js"></script>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<style>
.but-al{
margin-top:27px !important;
}

label.required::after {
    content: '* ';
    color: red;
}
.hidden {
    display: none;
}
</style>

<div class="container-fluid" style="margin-top: -100px; position: relative; z-index:99">
<%@ include file="/WEB-INF/views/message.jsp"%>
                <div class="row inner-cardbox">
                    <h6> Book Reissue</h6>
                    <hr>
                    
            <form action="${contextPath}/mst/manage-reIssueBook" method="post" id="manageReturnBookForm" >
            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" /> 
            <input type="hidden" name="bookIssueVO.bookIssuedId" value="${bookissueDtls.bookIssueVO.bookIssuedId}" />
                <div class="row">
                 
                     <div class="col-md-4">
		                <div class="form-group">
		                  <label  for="publisherName">Book Name :</label>
		                 	 <input type="text" class="form-control form-control-sm NumbersOnly" id="isbnNo" value="${bookissueDtls.bookIssueVO.bookId.bookUkNo}" readonly="readonly">
		                </div>
		              </div>
                 
                      <!-- <div class="col-md-4">
		                <div class="form-group">
		                  <label class="required" for="publisherName">Library Card :</label>
		                 	 <input type="text" class="form-control form-control-sm AlphabetsOnly" id="bookTitle" oninput="this.value = this.value.toUpperCase()" >
		                </div>
		              </div> -->
		              
		               <div class="col-md-4">
		                <div class="form-group">
		                  <label  for="address">Issued Date :</label>
							    <input type="text" class="form-control form-control-sm AlphabetsOnly" id="author"  value="${bookissueDtls.bookIssueVO.issuedDate}" readonly="readonly">
		                </div>
		              </div>
		              
		              <div class="col-md-4">
						 <div class="form-group">
						   <label  for="contact">Return date :</label>
						   <input type="text" class="form-control form-control-sm NumbersOnly" id="contact"   value="${bookissueDtls.bookIssueVO.returnDate}" readonly="readonly">
						 </div>
					 </div>
					 
					 <div class="col-md-4">
						 <div class="form-group">
						   <label  for="contact">Re-Issue date :</label>
						   <div class="datepicker-box">
						   <input type="text" class="form-control form-control-sm datepicker_con" name="bookIssueVO.reIssuedate" id="contact" >
						   <i class='bx bx-calendar'></i>
		                  	</div>
						 </div>
					 </div>
		              
		              <%-- <div class="col-md-4 " >
		                <div class="form-group">
		                  <label class="required" for="isreturn">Is Book return late :</label>
		                  	<select class="form-control form-control-sm " id="isreturn"  onchange="getHiddenFineAmount(this.value)" >
							        <option value="0">--Select--</option>
							        <option value="true">Yes</option>
							        <option value="false">No</option>
							</select>
		                </div>
		              </div>
		              
		              <div class="col-md-4 hidden" id="hiddenFineAmount">
						 <div class="form-group">
						   <label class="required" for="fineAmount">Fine Amount :</label>
						   <input type="text" class="form-control form-control-sm NumbersOnly" id="fineAmount" name="bookIssueVO.fineAmount" value="${bookissueDtls.fineAmount}">
						 </div>
					 </div>
					 
					 <div class="col-md-4 " >
						 <div class="form-group">
						   <label class="required" for="bookCondition">Book Condition :</label>
						   <select class="form-control form-control-sm " id="bookCondition" name="bookIssueVO.bookCondition"  >
							        <option value="0">--Select--</option>
							        <option value="GOOD">Good</option>
							        <option value="DAMAGED">Damaged</option>
							        <option value="LOST">Lost</option>
							</select>
						 </div>
					 </div> --%>
		              
		             <div class="col-md-12">
						<button type="button" class="btn btn-success btn-sm" onclick = "saveForm()">Submit</button>
				  	</div>
           	</div>
           	
           	
            </form>
            </div>
        </div>	
        
<script>

function saveForm(){
	debugger;
	 /* var labels = document.querySelectorAll('label[class="required"]');
	var falseFields=0;
	labels.forEach(function(label) {
		if(falseFields == 0){
	    var labelId = label.getAttribute('for');
	    var inputElement = document.getElementById(labelId);

	        var inputValue = inputElement.value;
	        if (inputValue === '' || inputValue === undefined || inputValue === '0') {
	            alert(label.textContent +"is required");
	            falseFields ++;
	            return false;
	        } 
		}
	}); */
	
	if($("#isreturn").val() == '0'){
		alert("Please select Is Book Return Late");
		return false;
	}else if($("#bookCondition").val() == '0'){
		alert("Please select Book Condition");
		return false;
	}else{
		if($("#isreturn").val() == 'true'){
			if($("#fineAmount").val() == '' || $("#fineAmount").val() == null){
				alert("Please Enter Fine Amount");
				return false;
			}else{
				$("#manageReturnBookForm").submit();
			}
		}else{
			$("#manageReturnBookForm").submit();
		}
	}
	
/* if (falseFields == 0) {
 }  */
}

function getHiddenFineAmount(value) {
    var hiddenField = document.getElementById("hiddenFineAmount");

    if (value === "true") {
        hiddenField.classList.remove("hidden");
    } else {
        hiddenField.classList.add("hidden");
    }
}



</script>    

